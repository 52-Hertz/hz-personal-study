#####  一、简单使用：

1. 进入要管理的目录

2. git init ==> 初始化，让 git 管理文件

3. git status ==> 检测当前目录下的文件状态

4. git add <文件名>/< . > ==> 使用git管理文件

5. 个人信息配置【只有第一次配置时需要】

   -  git config --global user.email "1849935097@qq.com" | git config --global user.name "heyupeng"

6. git commit -m '描述信息' ==> 将已经管理的文件生成版本 

7. 文件三种状态的变化：

   - 红色：新增的文件/修改后的老文件
   - 绿色：git已经管理的文件
   - 生成版本

8. git log ==> 查看当前版本记录

   git reflog ==> 查看所有版本记录(包括回滚之前的)

------

##### 二、分区

1. git reset --hard <版本号> ==> 回滚到对应版本号的版本
2. git reset HEAD <文件名> ==> 从暂存区回到工作区[红色部分] 
3. git checkout -- <文件名> ==> 工作区从红色部分回到修改前的状态
4. 工作区相互转换

------

##### 三、分支【解决线上bug】

1. git branch ==> 查看分支，*表示当前所在分支
2. git branch <新分支名> ==> 创建新分支
3. git checkout <分支名称> ==> 切换分支
4. git merge <要合并的分支名> ==> 将该分支合并到目标分支上(先切换到目标分支)
   - 可能产生冲突，手动解决冲突

5. git branch -d <分支名称> ==> 删除分支

##### 四、工作流

1. master分支 ==> 线上版本
2. dev 分支 ==> 开发分支：用于写代码，测试后合并到master分支上

##### 五、远程仓库

1. git remote add origin <远程仓库地址> ==> 给远程仓库起别名，别名为origin(别名起一次即可)
2. git push -u origin <远程分支名> ==> 向远程仓库对应分支推送代码
   - -u 表示默认，下一次再推送代码时，直接git push即可
   - 不加 -u 表示每次推送时都要手动指定远程分支(初期推荐用这个)
   - 末尾加 -f 表示强制覆盖远端分支r
   
3. git pull origin <分支名> ==> 从远端拉取最新代码到本地分支
   - 当第一次git clone后，以后从远端更新本地代码时，直接git pull <分支名>拉取即可
   - git pull origin <分支名> == git fetch origin <分支名> | git merge origin/<分支名>
   - git fetch origin <分支名> ==> 将远程分支拉到版本库
   - 从远程仓库中fetch下来的分支有 origin/ 前缀

------

##### 六、变基(rebase)

1. 多个提交记录整合为一个
   - 不要将已经push到远程仓库的记录合并，远程仓库提交记录和本地提交记录不一致会造成拉取代码时很麻烦
   - git rebase -i  HEAD~<阿拉伯数字n> ==> 从当前位置开始找最近的n条记录进行合并
   - 例：将 v4 v3 v2 三条记录合并至v2的版本位置(s 表示合并至上一个版本)

2. 合并分支
   1. git checkout <待合并的分支> ==> 切换到待合并的分支
   2. git rebase <目标分支> ==> 先将目标分支合并到当前的分支
   3. git checkout <目标分支> ==> 切换回目标分支
   4. git merge <想要合并的分支> ==> 将待合并的分支合并到目标分支上
   5. 例：将 dev分支 rebase 到 master分支 上
      - git checkout dev
      - git rebase master
      - git checkout master
      - git merge dev

3. 避免本地代码提交版本库后再从远程仓库拉取新代码时产生分叉
   1. git fetch origin dev
   2. git rebase origin/dev

4. git rebase 冲突
   1. 解决冲突-->按提示操作(add、commit.....)-->git rebase --continue
   2. 发生冲突时会中断，解决后可以继续之前的rebase

------

##### 七、多人协同开发

1. git tag -a <版本> -m "<第几版>" ==> 在本地向刚刚提交的记录打上标签，用来记录版本
2. git push origin --tags ==> 将刚刚在本地打上的标签推送至远端仓库
3. git clone -b <版本> 地址 ==>下载指定版本代码

##### 八、免密登录

1. 修改URL方式

   1. git remote add origin https://<用户名>:<密码>@<远程仓库连接>
   2. git push origin master
   3. 当已经有配置好地址时可以修改配置文件：vim .git/config ==> 修改本地配置文件的url

2. SSH实现【企业中用这个】

   1. ssh-keygen ==> 在电脑上生成公钥和私钥
      - 生成的公钥(id_rsa.pub)和私钥(id_rsa)默认放在~/.ssh目录下

   2. 拷贝公钥的内容，设置到github中
   3. 在git本地中配置ssh地址
      - git remote add origin <SSH地址>

3. git自动管理凭证

##### 九、git忽略文件

1. vim .gitignore ==> 在gtiignore文件中可以添加不想被git管理的文件以及路径
2. 可以在github中查找gitignore，选择对应语言的gitignore文件

##### 十、任务管理

1. issues
2. wiki

------

##### 常用操作：

1. ```shell
   git blame #界面可以查看文件修改历史
   
   #选中文件, 按 b 即可进入该文件的 blame 界面, 在 blame 中选中任意一行回车, 即可在界面的一半展示此次 commit 的所有内容, 依然
   #可以用 j/k 控制详情内容的单行移动, 回车跳转到某文件
   ```

2. ```shell
   git reset --<参数> HEAD^
   ## --soft  
   不删除工作空间改动代码，撤销commit，不撤销git add . 
   ### --mixed 
   意思是：不删除工作空间改动代码，撤销commit，并且撤销git add . 操作
   这个为默认参数,git reset --mixed HEAD^ 和 git reset HEAD^ 效果是一样的。
   ## --hard
   删除工作空间改动代码，撤销commit，撤销git add . 
   注意完成这个操作后，就恢复到了上一次的commit状态。
   ```

3. ```shell
   # 强制覆盖本地文件
   # 从远程下载最新的，而不尝试合并或rebase任何东西 
   git fetch --all 
   # 将主分支重置为您刚刚获取的内容 
   git reset --hard origin/<branch_name>
   ```

4. ```shell
   # commit时临时修改author名字
   git commit --amend --author="NewAuthor <NewEmail@address.com>"
   
   # 设置全局
   git config --global user.name "Author Name"
   git config --global user.email "Author Email"
   
   # 或者设置本地项目库配置
   git config user.name "Author Name"
   git config user.email "Author Email"
   ```

5. ```shell
   #push和pull代码时：在那个分支rebase，说明修改的就是那个分支
   
   #Push：
   dev分支：git rebase master。修改的是dev分支，然后将master rebase到dev上，使得dev为最新的代码，然后push
   master分支：git rebase dev，将dev中的代码rebase到master上，然后push
   ```

6. ```shell
   #本地三个分支
   #DEV ==> personal heyupeng_dev
   #FAT ==> personal heyupeng_dev
   #master ==> origin master
   ```

7. ```shell
   # 配置git pull 默认使用 rebase
   git config --global branch.autosetuprebase always
   ```

8. ```shell
   # 在dev上开发，每次开发时都要先pull最新的dev代码
   # 在master上git rebase dev ==> git rebase -i合并多个commit
   # push成功后，以master为准冲掉dev的记录，
   git push personal -f HEAD:dev
   # 分别pull master和dev
   ```

9. 

   ```shell
   # 拉远程分支dev 关联并新建 本地分支dev
   git checkout -b dev personal/dev
   
   # 新拉dev分支时，先在master上
   git fetch personal dev # 先把personal远程库的dev拉下来，但是不要与本地合并
   git checkout -b dev personal/dev # 新建本地dev分支并关联刚刚拉下来的远程dev分支
   git rebase personal/dev
   ```

10. ```shell
    # 修改远程仓库地址
    git remote set-url origin [url]
    ```

11. ```shell
    # 添加到.gitignore中无效
    git rm -r --cached 文件(夹)名 # 清除git缓存,因为之前提交过，所以ignore无效，清除缓存后就可以了
    git rm -r --cached . # 清空git缓存
    
    # 删除文件：
    git rm 文件名
    
    # 删除文件夹
    git rm -r 文件夹名
    
    # 重命名本地分支
    git branch -m oldName newName
    
    # 查看文件每次修改的diff
    git log -p filename
    ```

    

